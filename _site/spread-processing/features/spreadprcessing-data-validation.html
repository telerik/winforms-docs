<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Data Validation</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Data Validation">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            


<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">


</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("spread-processing/features/spreadprcessing-data-validation.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/spread-processing/features/spreadprcessing-data-validation.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="data-validation"><a href="#data-validation">Data Validation</a></h1>

<p><strong>Data validation</strong> is used to control the type of data or the values that users enter into a cell. Compared to <a href="/devtools/winforms/spread-processing/features/protection/spreadprocessing-workbook">Protection</a>, data validation does not restrict the user input, but ensures that the entered data complies with certain rules. For example the user may be restricted to enter data only within a certain range of dates, whole numbers, decimal numbers, or from a list of predefined values.</p>

<h2 id="data-validation-rules"><a href="#data-validation-rules">Data Validation Rules</a></h2>

<p>The data validation rules helps you restrict the user input. Additionally, you can set a message which will be shown when the cell containing the rule is selected once the current workbook is shown in a spreadsheet UI control.</p>

<p>You have the ability to specify how the user will be notified if the rule is not satisfied. There are three types of notifications:</p>

<ul>
<li><p><strong>Error</strong>: If the user enters invalid data, a message box gives him the following choice:</p></li>
<li><p>Retry: Try again.</p></li>
<li><p>Cancel the change.</p></li>
<li><p><strong>Cancel</strong>: If the user enters invalid data, a message box gives him the following choice:</p></li>
<li><p>Yes: Override the warning and apply the change.</p></li>
<li><p>No: Try again.</p></li>
<li><p>Cancel: Revert the change.</p></li>
<li><p><strong>Information</strong>: If the user enters invalid data, a message box gives him the following choice:</p></li>
<li><p>OK: Override the warning and apply the change.</p></li>
<li><p>Cancel: Revert the change.</p></li>
</ul>

<h2 id="data-validation-rule-types"><a href="#data-validation-rule-types">Data Validation Rule Types</a></h2>

<p>There are the following data validation rule types:</p>

<ul>
<li><p>Any value</p></li>
<li><p>Whole number</p></li>
<li><p>Decimal</p></li>
<li><p>List</p></li>
<li><p>Date</p></li>
<li><p>Time</p></li>
<li><p>Text Length</p></li>
<li><p>Custom</p></li>
</ul>

<p>To be able to create data validation rules you have to pass parameters to the rule. This is done using data validation rule contexts. There are several context types with different parameters which are used for the different types of data validation rules.</p>

<h2 id="anyvaluedatavalidationrulecontext"><a href="#anyvaluedatavalidationrulecontext">AnyValueDataValidationRuleContext</a></h2>

<p>The <strong>AnyValueDataValidationRuleContext</strong> class exposes the following properties:</p>

<ul>
<li><p><strong>ShowInputMessage</strong>: Specifies whether to show input message or not.</p></li>
<li><p><strong>InputMessageTitle</strong>: The title of the input message.</p></li>
<li><p><strong>InputMessageContent</strong>: The content of the input message.</p></li>
<li><p><strong>ShowErrorMessage</strong>: Specifies whether to show error message or not.</p></li>
<li><p><strong>ErrorStyle</strong>: Specifies the style of the error message. The possible choices are Error, <em>Warning</em> and <em>Information</em>.</p></li>
</ul>

<h2 id="singleargumentdatavalidationrulecontext"><a href="#singleargumentdatavalidationrulecontext">SingleArgumentdataValidationRuleContext</a></h2>

<p>The <strong>SingleArgumentdataValidationRuleContext</strong> exposes the properties which the <strong>AnyValueDataValidationRuleContext</strong> class has, but extends them with the following properties:</p>

<ul>
<li><p><strong>IgnoreBlank</strong>: Specifies if the validation will ignore blank values and this way consider them as valid values.</p></li>
<li><p><strong>Argument1</strong>: Тhe argument needed for the validation.</p></li>
<li><p><strong>CellIndex</strong>: The cell index of the cell based on which the validation rule is created.</p></li>
<li><p><strong>Worksheet</strong>: The worksheet in which the data validation rule is created.</p></li>
</ul>

<h2 id="numberdatavalidationrulecontext"><a href="#numberdatavalidationrulecontext">NumberDataValidationRuleContext</a></h2>

<p><strong>NumberDataValidationRuleContext</strong> exposes the properties which the <strong>SingleArgumentDataValidationRuleContext</strong> class has, but extends them with the following properties:</p>

<ul>
<li><p><strong>ComparisonOperator</strong>: The comparison operator used by the data validation rule.</p></li>
<li><p><strong>Argument2</strong>: The second argument needed by the data validation rule.</p></li>
</ul>

<h2 id="listdatavalidationrulecontext"><a href="#listdatavalidationrulecontext">ListDataValidationRuleContext</a></h2>

<p><strong>ListDataValidationRuleContext</strong> exposes the properties which the <strong>SingleArgumentDataValidationRuleContext</strong> class has, but extends them with the following properties:</p>

<ul>
<li>
<strong>InCellDropdown</strong>: Specifies if a drop-down containing the list values of the data validation rule should be shown.</li>
</ul>

<h2 id="any-value-rule"><a href="#any-value-rule">Any Value Rule</a></h2>

<p>The any value data validation rule is the default rule. It is applied to all cells and it does not perform any data validation. You can simply specify an input message. The error message is never shown because in this rule all values are considered as valid input.</p>

<p><strong>Example 1</strong> shows hot to create any value validation rule and set it to a cell.</p>

<h4><strong>[C#] Example 1: Apply Any Value Rule</strong></h4>

<pre><code>            AnyValueDataValidationRuleContext context = new AnyValueDataValidationRuleContext();
            context.InputMessageContent = "Sample input message content";
            context.InputMessageTitle = "Sample input message title";
            AnyValueDataValidationRule rule = new AnyValueDataValidationRule(context);

            worksheet.Cells[0, 0].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 1: Apply Any Value Rule</strong></h4>

<pre><code>        Dim context As New AnyValueDataValidationRuleContext()
        context.InputMessageContent = "Sample input message content"
        context.InputMessageTitle = "Sample input message title"
        Dim rule As New AnyValueDataValidationRule(context)

        worksheet.Cells(0, 0).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyWholeNumberRulewithTwoArguments(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_1"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values between 0 and 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are in the range between 0 and 100!"
        context.IgnoreBlank = False
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "0"
        context.Argument2 = "100"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyWholeNumberRuleWithOneArgument(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_2"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values greater than 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!"
        context.ComparisonOperator = ComparisonOperator.GreaterThan
        context.Argument1 = "100"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyWholeNumberRuleWithFormula(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_3"
        ' The value of A1
        worksheet.Cells(0, 0).SetValue(60)
        ' The value of B1
        worksheet.Cells(0, 1).SetValue(40)

        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values greater than 100"
        context.ErrorStyle = ErrorStyle.Warning
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!"
        context.ComparisonOperator = ComparisonOperator.LessThan
        context.Argument1 = "=Sum(A1+B1)"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_4"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to decimal number values out of the range between 0 and 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all decimal number values out of the range between 0 and 100!"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "0"
        context.Argument2 = "100"

        Dim rule As New DecimalDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule2(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_5"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New ListDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to the week days."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are the week days!"
        context.InCellDropdown = True
        context.Argument1 = "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday"

        Dim rule As New ListDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_6"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to dates in the range from 12 February 2013 to 22 May 2017."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all dates between 12 February 2013 and 22 May 2017"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2013, 2, 12).ToShortDateString()
        context.Argument2 = New DateTime(2017, 5, 22).ToShortDateString()

        Dim rule As New DateDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTimeRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_7"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString()
        context.Argument2 = New DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString()

        Dim rule As New TimeDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTextLengthRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_8"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<p>The result from the code snippet in <strong>Example 1</strong> is shown on the snapshot in <strong>Figure 1</strong>.</p>

<p>Figure 1: Any Value Rule<img src="images/spreadprocessing-features-data-validation001.png" alt="spreadprocessing-features-data-validation 001"></p>

<h2 id="whole-number-rule"><a href="#whole-number-rule">Whole Number Rule</a></h2>

<p>The whole number data validation rule allows you to restrict the user input to whole numbers in a certain range. The range is specified using two arguments and a comparison operator. In some cases, for example when restricting user input in the range between 0 and 100, both arguments are used. In other cases like restricting the input to numbers that are greater than 100, only one of the arguments is used. Additionally, there is an option to ignore the blank values which is turned on by default.</p>

<p>The code snippet in <strong>Example 2</strong> shows how to create a whole number data validation rule that restricts the user input using two arguments to the range between 0 and 100 and considers blank values as invalid.</p>

<h4><strong>[C#] Example 2: Apply Whole Number Rule with Two Arguments</strong></h4>

<pre><code>            CellIndex dataValidationRuleCellIndex = new CellIndex(0, 0);

            NumberDataValidationRuleContext context = new NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to whole number values between 0 and 100";
            context.ErrorStyle = ErrorStyle.Stop;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. Allowed values are in the range between 0 and 100!";
            context.IgnoreBlank = false;
            context.ComparisonOperator = ComparisonOperator.Between;
            context.Argument1 = "0";
            context.Argument2 = "100";

            WholeNumberDataValidationRule rule = new WholeNumberDataValidationRule(context);

            worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 2: Apply Whole Number Rule with Two Arguments</strong></h4>

<pre><code>        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values between 0 and 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are in the range between 0 and 100!"
        context.IgnoreBlank = False
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "0"
        context.Argument2 = "100"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyWholeNumberRuleWithOneArgument(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_2"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values greater than 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!"
        context.ComparisonOperator = ComparisonOperator.GreaterThan
        context.Argument1 = "100"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyWholeNumberRuleWithFormula(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_3"
        ' The value of A1
        worksheet.Cells(0, 0).SetValue(60)
        ' The value of B1
        worksheet.Cells(0, 1).SetValue(40)

        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values greater than 100"
        context.ErrorStyle = ErrorStyle.Warning
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!"
        context.ComparisonOperator = ComparisonOperator.LessThan
        context.Argument1 = "=Sum(A1+B1)"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_4"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to decimal number values out of the range between 0 and 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all decimal number values out of the range between 0 and 100!"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "0"
        context.Argument2 = "100"

        Dim rule As New DecimalDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule2(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_5"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New ListDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to the week days."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are the week days!"
        context.InCellDropdown = True
        context.Argument1 = "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday"

        Dim rule As New ListDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_6"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to dates in the range from 12 February 2013 to 22 May 2017."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all dates between 12 February 2013 and 22 May 2017"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2013, 2, 12).ToShortDateString()
        context.Argument2 = New DateTime(2017, 5, 22).ToShortDateString()

        Dim rule As New DateDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTimeRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_7"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString()
        context.Argument2 = New DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString()

        Dim rule As New TimeDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTextLengthRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_8"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<p>The result from <strong>Example 2</strong> is shown in <strong>Figure 1</strong>.</p>

<p>Figure 2: Whole Number Rule<img src="images/spreadprocessing-features-data-validation002.png" alt="spreadprocessing-features-data-validation 002"></p>

<p>The result from entering value <em>“test”</em> in the cell containing the data validation rule is shown on <strong>Figure 3</strong>.</p>

<p>Figure 3: Whole Number Rule Invalid Result<img src="images/spreadprocessing-features-data-validation003.png" alt="spreadprocessing-features-data-validation 003"></p>

<p>The code snippet in <strong>Example 3</strong> shows how to create a whole number data validation rule that restricts the user input with one argument to numbers that are greater than 100.</p>

<h4><strong>[C#] Example 3: Apply Whole Number Rule with One Argument</strong></h4>

<pre><code>            CellIndex dataValidationRuleCellIndex = new CellIndex(0, 0);

            NumberDataValidationRuleContext context = new NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to whole number values greater than 100";
            context.ErrorStyle = ErrorStyle.Stop;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!";
            context.ComparisonOperator = ComparisonOperator.GreaterThan;
            context.Argument1 = "100";

            WholeNumberDataValidationRule rule = new WholeNumberDataValidationRule(context);

            worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 3: Apply Whole Number Rule with One Argument</strong></h4>

<pre><code>        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values greater than 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!"
        context.ComparisonOperator = ComparisonOperator.GreaterThan
        context.Argument1 = "100"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyWholeNumberRuleWithFormula(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_3"
        ' The value of A1
        worksheet.Cells(0, 0).SetValue(60)
        ' The value of B1
        worksheet.Cells(0, 1).SetValue(40)

        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values greater than 100"
        context.ErrorStyle = ErrorStyle.Warning
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!"
        context.ComparisonOperator = ComparisonOperator.LessThan
        context.Argument1 = "=Sum(A1+B1)"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_4"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to decimal number values out of the range between 0 and 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all decimal number values out of the range between 0 and 100!"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "0"
        context.Argument2 = "100"

        Dim rule As New DecimalDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule2(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_5"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New ListDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to the week days."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are the week days!"
        context.InCellDropdown = True
        context.Argument1 = "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday"

        Dim rule As New ListDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_6"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to dates in the range from 12 February 2013 to 22 May 2017."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all dates between 12 February 2013 and 22 May 2017"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2013, 2, 12).ToShortDateString()
        context.Argument2 = New DateTime(2017, 5, 22).ToShortDateString()

        Dim rule As New DateDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTimeRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_7"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString()
        context.Argument2 = New DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString()

        Dim rule As New TimeDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTextLengthRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_8"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<p>You are allowed to enter any valid <a href="/devtools/winforms/spread-processing/features/spreadprocessing-formulas">formula</a> as a rule argument that returns a number. <strong>Example 4</strong> shows how to restrict the user input to the values less than the sum of the values in cells A1 and B1.</p>

<h4><strong>[C#] Example 4: Apply Whole Number Rule with Formula</strong></h4>

<pre><code>            // The value of A1
            worksheet.Cells[0, 0].SetValue(60);
            // The value of B1
            worksheet.Cells[0, 1].SetValue(40);

            CellIndex dataValidationRuleCellIndex = new CellIndex(1, 0);

            NumberDataValidationRuleContext context = new NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to whole number values greater than 100";
            context.ErrorStyle = ErrorStyle.Warning;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!";
            context.ComparisonOperator = ComparisonOperator.LessThan;
            context.Argument1 = "=Sum(A1+B1)";

            WholeNumberDataValidationRule rule = new WholeNumberDataValidationRule(context);

            worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 4: Apply Whole Number Rule with Formula</strong></h4>

<pre><code>        ' The value of A1
        worksheet.Cells(0, 0).SetValue(60)
        ' The value of B1
        worksheet.Cells(0, 1).SetValue(40)

        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to whole number values greater than 100"
        context.ErrorStyle = ErrorStyle.Warning
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all whole number values greater than 100!"
        context.ComparisonOperator = ComparisonOperator.LessThan
        context.Argument1 = "=Sum(A1+B1)"

        Dim rule As New WholeNumberDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_4"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to decimal number values out of the range between 0 and 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all decimal number values out of the range between 0 and 100!"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "0"
        context.Argument2 = "100"

        Dim rule As New DecimalDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule2(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_5"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New ListDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to the week days."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are the week days!"
        context.InCellDropdown = True
        context.Argument1 = "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday"

        Dim rule As New ListDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_6"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to dates in the range from 12 February 2013 to 22 May 2017."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all dates between 12 February 2013 and 22 May 2017"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2013, 2, 12).ToShortDateString()
        context.Argument2 = New DateTime(2017, 5, 22).ToShortDateString()

        Dim rule As New DateDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTimeRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_7"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString()
        context.Argument2 = New DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString()

        Dim rule As New TimeDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTextLengthRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_8"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<p>Figure 4: Whole Number Rule Based on Formula<img src="images/spreadprocessing-features-data-validation004.png" alt="spreadprocessing-features-data-validation 004"></p>

<blockquote>
<p>Note that the cell index that is passed to the constructor of the <strong>NumberDataValidationRuleContext</strong> is the cell for which the rule is created. Consider the case in which an area from A2 to C5 is selected using the UI and the active cell is A2. You create the same rule as in <strong>Example 4</strong> but apply it not just for cell A2, but for the cell range A2:C5. The formula “=SUM(A1+B1)” contains two relative cell references – A1 and B1. If you select the cell C5 and open the data validation dialog you will see that the formula that specifies the minimum value is “=SUM(C4+D4)” instead of “=SUM(A1+B1)”. The relative references in the formula are translated relatively to the cell passed in the constructor of the data validation rule context.</p>
</blockquote>

<h2 id="decimal-rule"><a href="#decimal-rule">Decimal Rule</a></h2>

<p>The decimal data validation rule allows you to restrict the user input to decimal numbers in a certain range which is specified using two arguments and a comparison operator. The difference from the whole number Rule is that the decimal rule allows whole and decimal numbers to be entered in the cells.</p>

<p><strong>Example 5</strong> demonstrates how to create a decimal data validation rule that restricts the user input to be outside the range between 0 and 100.</p>

<h4><strong>[C#] Example 5: Apply Decimal Rule</strong></h4>

<pre><code>            CellIndex dataValidationRuleCellIndex = new CellIndex(0, 0);

            NumberDataValidationRuleContext context = new NumberDataValidationRuleContext(this.worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to decimal number values out of the range between 0 and 100";
            context.ErrorStyle = ErrorStyle.Stop;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. Allowed values are all decimal number values out of the range between 0 and 100!";
            context.ComparisonOperator = ComparisonOperator.Between;
            context.Argument1 = "0";
            context.Argument2 = "100";

            DecimalDataValidationRule rule = new DecimalDataValidationRule(context);

            this.worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 5: Apply Decimal Rule</strong></h4>

<pre><code>        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to decimal number values out of the range between 0 and 100"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all decimal number values out of the range between 0 and 100!"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "0"
        context.Argument2 = "100"

        Dim rule As New DecimalDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDecimalRule2(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_5"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New ListDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to the week days."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are the week days!"
        context.InCellDropdown = True
        context.Argument1 = "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday"

        Dim rule As New ListDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_6"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to dates in the range from 12 February 2013 to 22 May 2017."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all dates between 12 February 2013 and 22 May 2017"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2013, 2, 12).ToShortDateString()
        context.Argument2 = New DateTime(2017, 5, 22).ToShortDateString()

        Dim rule As New DateDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTimeRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_7"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString()
        context.Argument2 = New DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString()

        Dim rule As New TimeDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTextLengthRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_8"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="list-rule"><a href="#list-rule">List Rule</a></h2>

<p>The list data validation rule allows you to restrict the user input to a predefined set of values. Using the <strong>InCellDropdown</strong> property you can specify if a drop-down list containing the values will be shown next to the cell.</p>

<p><strong>Example 6</strong> shows the creation of a list data validation rule that restricts the user input to a day of the week.</p>

<h4><strong>[C#] Example 6: Apply List Rule</strong></h4>

<pre><code>            CellIndex dataValidationRuleCellIndex = new CellIndex(0, 0);

            ListDataValidationRuleContext context = new ListDataValidationRuleContext(worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to the week days.";
            context.ErrorStyle = ErrorStyle.Stop;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. Allowed values are the week days!";
            context.InCellDropdown = true;
            context.Argument1 = "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday";

            ListDataValidationRule rule = new ListDataValidationRule(context);

            worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 6: Apply List Rule</strong></h4>

<pre><code>        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New ListDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to the week days."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are the week days!"
        context.InCellDropdown = True
        context.Argument1 = "Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday"

        Dim rule As New ListDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyDateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_6"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to dates in the range from 12 February 2013 to 22 May 2017."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all dates between 12 February 2013 and 22 May 2017"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2013, 2, 12).ToShortDateString()
        context.Argument2 = New DateTime(2017, 5, 22).ToShortDateString()

        Dim rule As New DateDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTimeRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_7"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString()
        context.Argument2 = New DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString()

        Dim rule As New TimeDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTextLengthRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_8"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<p><strong>Figure 5</strong> shows the result from <strong>Example 6</strong>.</p>

<p>Figure 5: List Rule<img src="images/spreadprocessing-features-data-validation005.png" alt="spreadprocessing-features-data-validation 005"></p>

<h2 id="date-rule"><a href="#date-rule">Date Rule</a></h2>

<p>The date rule allows you to restrict the user input to a certain range of dates which is specified using two arguments and a comparison operator.</p>

<p><strong>Example 7</strong> shows how to restrict the user input to the dates in the range between 12 February 2013 and 22 May 2017.</p>

<h4><strong>[C#] Example 7: Apply List Rule</strong></h4>

<pre><code>            CellIndex dataValidationRuleCellIndex = new CellIndex(0, 0);

            NumberDataValidationRuleContext context = new NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to dates in the range from 12 February 2013 to 22 May 2017.";
            context.ErrorStyle = ErrorStyle.Stop;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. Allowed values are all dates between 12 February 2013 and 22 May 2017";
            context.ComparisonOperator = ComparisonOperator.Between;
            context.Argument1 = new DateTime(2013, 2, 12).ToShortDateString();
            context.Argument2 = new DateTime(2017, 5, 22).ToShortDateString();

            DateDataValidationRule rule = new DateDataValidationRule(context);

            worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 7: Apply List Rule</strong></h4>

<pre><code>        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to dates in the range from 12 February 2013 to 22 May 2017."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all dates between 12 February 2013 and 22 May 2017"
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2013, 2, 12).ToShortDateString()
        context.Argument2 = New DateTime(2017, 5, 22).ToShortDateString()

        Dim rule As New DateDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTimeRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_7"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString()
        context.Argument2 = New DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString()

        Dim rule As New TimeDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTextLengthRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_8"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="time-rule"><a href="#time-rule">Time Rule</a></h2>

<p>The time rule allows you to restrict the user input to a certain range of times which is specified using two arguments and a comparison operator.</p>

<p>The code snippet in <strong>Example 8</strong> shows how to restrict the user input to the range between 10:25 AM and 3:45 PM:</p>

<h4><strong>[C#] Example 8: Apply Time Rule</strong></h4>

<pre><code>            CellIndex dataValidationRuleCellIndex = new CellIndex(0, 0);

            NumberDataValidationRuleContext context = new NumberDataValidationRuleContext(this.worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM.";
            context.ErrorStyle = ErrorStyle.Stop;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM.";
            context.ComparisonOperator = ComparisonOperator.Between;
            context.Argument1 = new DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString();
            context.Argument2 = new DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString();

            TimeDataValidationRule rule = new TimeDataValidationRule(context);

            this.worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 8: Apply Time Rule</strong></h4>

<pre><code>        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(Me.worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to times in the range from 10:25 AM to 3:45 PM."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. Allowed values are all times between 10:25 AM to 3:45 PM."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = New DateTime(2015, 2, 2, 10, 25, 0).ToShortTimeString()
        context.Argument2 = New DateTime(2015, 2, 2, 15, 45, 0).ToShortTimeString()

        Dim rule As New TimeDataValidationRule(context)

        Me.worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyTextLengthRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_8"
        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="time-length-rule"><a href="#time-length-rule">Time Length Rule</a></h2>

<p>The text length rule allows you to restrict the user input to text with length in a certain range specified using two arguments and a comparison operator.</p>

<p><strong>Example 9</strong> shows how to restrict the user input to text with length between 5 and 10 symbols.</p>

<h4><strong>[C#] Example 9: Apply Text Length Rule</strong></h4>

<pre><code>            CellIndex dataValidationRuleCellIndex = new CellIndex(0, 0);

            NumberDataValidationRuleContext context = new NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols";
            context.ErrorStyle = ErrorStyle.Stop;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols.";
            context.ComparisonOperator = ComparisonOperator.Between;
            context.Argument1 = "5";
            context.Argument2 = "10";

            TextLengthDataValidationRule rule = new TextLengthDataValidationRule(context);

            worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 9: Apply Text Length Rule</strong></h4>

<pre><code>        Dim dataValidationRuleCellIndex As New CellIndex(0, 0)

        Dim context As New NumberDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to text with length between 5 and 10 symbols"
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only text with length between 5 and 10 symbols."
        context.ComparisonOperator = ComparisonOperator.Between
        context.Argument1 = "5"
        context.Argument2 = "10"

        Dim rule As New TextLengthDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub ApplyCustomRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_9"
        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="custom-rule"><a href="#custom-rule">Custom Rule</a></h2>

<p>The custom rule allows you to restrict the user input with a custom condition specified with a formula which results in a <strong>Boolean</strong> value.</p>

<p>The code snippet in <strong>Example 10</strong> shows how to restrict the user input to values that are greater or equal to the sum of the values in the cells A1 and B1.</p>

<h4><strong>[C#] Example 10: Apply Custom Rule</strong></h4>

<pre><code>            CellIndex dataValidationRuleCellIndex = new CellIndex(1, 0);

            SingleArgumentDataValidationRuleContext context = new SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex);
            context.InputMessageTitle = "Restricted input";
            context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1.";
            context.ErrorStyle = ErrorStyle.Stop;
            context.ErrorAlertTitle = "Wrong value";
            context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1";
            context.Argument1 = "=A2=Sum(A1, B1)";

            CustomDataValidationRule rule = new CustomDataValidationRule(context);

            worksheet.Cells[dataValidationRuleCellIndex].SetDataValidationRule(rule);
</code></pre>

<h4><strong>[VB] Example 10: Apply Custom Rule</strong></h4>

<pre><code>        Dim dataValidationRuleCellIndex As New CellIndex(1, 0)

        Dim context As New SingleArgumentDataValidationRuleContext(worksheet, dataValidationRuleCellIndex)
        context.InputMessageTitle = "Restricted input"
        context.InputMessageContent = "The input is restricted to values that are greater or equal to the sum of the values in the cells A1 and B1."
        context.ErrorStyle = ErrorStyle.[Stop]
        context.ErrorAlertTitle = "Wrong value"
        context.ErrorAlertContent = "The entered value is not valid. It is allowed to enter only values that are greater or equal to the sum of the values in the cells A1 and B1"
        context.Argument1 = "=A2=Sum(A1, B1)"

        Dim rule As New CustomDataValidationRule(context)

        worksheet.Cells(dataValidationRuleCellIndex).SetDataValidationRule(rule)
        '#End Region
    End Sub

    Private Sub EvaluateRule(worksheet As Worksheet, workbook As Workbook)
        '#Region "radspreadprocessing-features-data-validation_10"
        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="evaluate-rule"><a href="#evaluate-rule">Evaluate Rule</a></h2>

<p>In order to check if the cell value satisfies a rule, you have to evaluate the rule using the desired cell value. Each data validation rule implements the <strong>DataValidationRule</strong> interface which exposes the <strong>Evaluate()</strong> method. The method receives as parameters the worksheet in which the value is located, the cell index in which the value will be placed or in which the value is contained, and the value itself.</p>

<p><strong>Example 11</strong> demonstrates how to evaluate a rule using the <strong>Evaluate()</strong> method.</p>

<h4><strong>[C#] Example 11: Evaluate Rule</strong></h4>

<pre><code>            IEnumerable&lt;string&gt; stringItems = new List&lt;string&gt;() { "test", "1%", "1.0" };
            IEnumerable&lt;DateGroupItem&gt; dateItems = new List&lt;DateGroupItem&gt;()
            { 
                new DateGroupItem(2013),
                new DateGroupItem(2014, 3)
            };

            ValuesCollectionFilter filter = new ValuesCollectionFilter(0, stringItems, dateItems, true);
</code></pre>

<h4><strong>[VB] Example 11: Evaluate Rule</strong></h4>

<pre><code>        Dim stringItems As IEnumerable(Of String) = New List(Of String)() From {"test", "1%", "1.0"}
        Dim dateItems As IEnumerable(Of DateGroupItem) = New List(Of DateGroupItem)() From {New DateGroupItem(2013), New DateGroupItem(2014, 3)}
        Dim filter As New ValuesCollectionFilter(0, stringItems, dateItems, True)
        '#End Region
    End Sub
End Class
</code></pre>

<h1 id="see-also"><a href="#see-also">See Also</a></h1>

<ul>
<li><p><a href="/devtools/winforms/spread-processing/features/protection/spreadprocessing-workbook">Workbook Protection</a></p></li>
<li><p><a href="/devtools/winforms/spread-processing/features/spreadprocessing-formulas">Formulas</a></p></li>
</ul>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

