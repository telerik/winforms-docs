<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
        <title>Merge and Unmerge Cells</title>
		
        <link href="/devtools/winforms/favicon.ico?Version=2014" rel="shortcut icon" />
		
        <meta name="description" content="Merge and Unmerge Cells">
        <link href="http://cdn.kendostatic.com/2014.2.716/styles/kendo.common.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="/devtools/winforms/assets/styles-0b5a71aa940403cb3ac60d7e91e25e1d.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/theme-52ac78f88dc084a004a9f7d63a3c4245.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/branding-fafb6ed99bf90d251675534381e6f139.css">
        <link rel="stylesheet" href="/devtools/winforms/assets/highlight-49ceada082f1c903edb130c25d09cf1f.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://cdn.kendostatic.com/2014.2.716/js/kendo.web.min.js"></script>
        <script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/app-6da8e8e1ef6e19ee4a020ec34f48078c.js"></script>
		<script src="/devtools/winforms/assets/prettify-31f05a2784b46b14f119862e47123f4c.js"></script>
        <script src="/devtools/winforms/assets/branding-59377013fb75f02a1dbffd638033ef6d.js"></script>
		<script src="/devtools/winforms/assets/feedback-76cd418a099f8d21592f412fb4a31191.js"></script>
		
		<!--[if lt IE 9]>
		<script>
		document.createElement('header');
		document.createElement('nav');
		document.createElement('section');
		document.createElement('article');
		document.createElement('aside');
		document.createElement('footer');
		document.createElement('hgroup');
		</script>
		<![endif]-->
    </head>
    <body class="faux-columns">
        <!-- Google Tag Manager -->
        <noscript>
            <iframe src="//www.googletagmanager.com/ns.html?id=GTM-6X92" height="0" width="0" style="display: none; visibility: hidden"></iframe>
        </noscript>
        <script>(function(w, d, s, l, i) { w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' }); var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src = '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f); })(window, document, 'script', 'dataLayer', 'GTM-6X92');</script>
        <!-- End Google Tag Manager -->
        <header id="page-header">
			<span class="toggle-nav"><span></span></span>
            <div id="logo-bar">
	<a href="/devtools/winforms/" title="UI for WinForms">
		<span>UI for WinForms</span>
	</a>
</div> 
<div id="page-search">
	<script>
  (function() {
    var cx = '001595215763381649090:jt1stbj813w';
    var gcse = document.createElement('script');
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</div>

<span class="show-search">
	<span class="k-icon k-i-search"></span>
</span>

<div class="nav-buttons">
	<a href="http://demos.telerik.com/wpf/" title="WPF Demos" target="_blank" class="btn demos-btn">Demos</a>	
	<a href="http://www.telerik.com/products/wpf/overview.aspx" title="About UI for WPF" target="_blank" class="btn about-btn">About</a>
	<a href="http://www.telerik.com/purchase/individual/wpf.aspx" title="Pricing" target="_blank" class="btn pricing-btn">Pricing</a>
	<a href="http://www.telerik.com/products/wpf/download.aspx" title="Try now" target="_blank" class="btn btn-primary">Try now</a>
</div>





        </header>

        <div id="page-inner-content">
    <div id="page-nav">
        <div id="page-tree"></div>
        <script>
			$("#page-tree").kendoTreeView({
				dataSource: {
					transport: {
						read: {
							url: "/devtools/winforms/default.json",
							dataType: "json"
						}
					},
					schema: {
						model: {
							id: "path",
							children: "items",
							hasChildren: "items"
						}
					}
				},
				select: preventParentSelection,
				template: navigationTemplate("/devtools/winforms/"),
				dataBound: expandNavigation("spread-processing/features/spreadprocessing-merge-unmerge-cells.html")
			});
        </script>
		<div id="page-api" class="k-treeview">
			<ul class="k-group">
				<li class="k-item">
					<span class="k-icon k-plus" role="presentation"></span>
					<span class="k-in">
						<a href="/devtools/winforms/api/" target="_blank">API Reference</a>
					</span>
				</li>
			</ul>
		</div>			
    </div>
	<a id="page-edit-link" class="btn btn-action" href="https://github.com/telerik/xaml-docs/edit/master/spread-processing/features/spreadprocessing-merge-unmerge-cells.md">Edit this page</a>
    <div id="page-article">       
        <article>
            <h1 id="merge-and-unmerge-cells"><a href="#merge-and-unmerge-cells">Merge and Unmerge Cells</a></h1>

<p>You have the ability to merge two or more adjacent cells into a single cell that spans over multiple rows and columns. The content of the top-left cell is displayed in the newly created merged cell. The content of the rest of the cells in the merged region is cleared. Once merged, a cell can be easily unmerged back to its compound cells.</p>

<h2 id="merge-cells"><a href="#merge-cells">Merge Cells</a></h2>

<p>To merge cells you have to create a <strong>CellSelection</strong> object which determines the region of cells that will be merged. The <strong>CellSelection</strong> class offers two methods that perform different types of merge: <strong>Merge()</strong> and <strong>MergeAcross()</strong>. The former method joins all cells to create one big cell, while the latter combines all cells that appear in the same row, thus, creating a merged cell for every row in the selected region.</p>

<p>Let's take a closer look at how the two methods for merging change the following worksheet.</p>

<p><strong>Example 1</strong> constructs a worksheet that will be used as a starting point in the next few examples:</p>

<h4><strong>[C#] Example 1: Construct worksheet</strong></h4>

<pre><code>            Workbook workbook = new Workbook();
            Worksheet worksheet = workbook.Worksheets.Add();
            worksheet.Cells[0, 0].SetValue("A1");
            worksheet.Cells[1, 0].SetValue("A2");
            worksheet.Cells[0, 1].SetValue("B1");
            worksheet.Cells[1, 1].SetValue("B2");
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<p><strong>Figure 1</strong> shows the result of the snippet in <strong>Example 1</strong>.</p>

<p>Figure 1: Worksheet<img src="images/spreadprocessing-features-merge-unmerge-cells001.png" alt="spreadprocessing-features-merge-unmerge-cells 001"></p>

<p><strong>Example 2</strong> illustrates how to perform a merge operation on the cell region <em>A1:B2</em>.</p>

<h4><strong>[C#] Example 2: Perform merge operation</strong></h4>

<pre><code>            Workbook workbook = new Workbook();
            Worksheet worksheet = workbook.Worksheets.Add();
            CellIndex A1Cell = new CellIndex(0, 0);
            CellIndex B2Cell = new CellIndex(1, 1);

            worksheet.Cells[A1Cell, B2Cell].Merge();
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1Cell As New CellIndex(0, 0)
        Dim B2Cell As New CellIndex(1, 1)

        worksheet.Cells(A1Cell, B2Cell).Merge()

        '#End Region
    End Sub

    Public Sub MergeAcrossA1B2()
        '#Region radspreadprocessing-features-merge-unmerge-cells_1

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1Cell As New CellIndex(0, 0)
        Dim B2Cell As New CellIndex(1, 1)
        worksheet.Cells(A1Cell, B2Cell).MergeAcross()

        '#End Region
    End Sub

    Public Sub MergeB2C3()
        '#Region radspreadprocessing-features-merge-unmerge-cells_2

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2Cell As New CellIndex(1, 1)
        Dim C3Cell As New CellIndex(2, 2)
        worksheet.Cells(B2Cell, C3Cell).Merge()

        '#End Region
    End Sub

    Public Sub CheckA1IsMerged()
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        '#Region radspreadprocessing-features-merge-unmerge-cells_3

        Dim A1CellIndex As New CellIndex(0, 0)
        Dim isA1merged As Boolean = Worksheet.Cells.GetIsMerged(A1CellIndex)

        '#End Region
    End Sub

    Public Sub GetContainingMergedRangeForCellA1()
        '#Region radspreadprocessing-features-merge-unmerge-cells_4

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim mergedCellRange As CellRange
        Dim canGetContainingMergedCellRange As Boolean = worksheet.Cells.TryGetContainingMergedRange(A1CellIndex, mergedCellRange)

        '#End Region
    End Sub

    Public Sub GetAllContainingMergedRangesInRange()
        '#Region radspreadprocessing-features-merge-unmerge-cells_5

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim N33CellIndex As New CellIndex(32, 13)
        Dim A1N33CellRange As New CellRange(A1CellIndex, N33CellIndex)
        Dim containingMergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetContainingMergedRanges(A1N33CellRange)

        '#End Region
    End Sub

    Public Sub GetAllMergedCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_6

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim mergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetMergedCellRanges()

        '#End Region
    End Sub

    Public Sub UnmergeCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_7

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2CellIndex As New CellIndex(1, 1)
        Dim D4CellIndex As New CellIndex(3, 3)
        Dim B2D4CellSelection As New CellRange(B2CellIndex, D4CellIndex)
        worksheet.Cells(B2D4CellSelection).Unmerge()

        '#End Region
    End Sub

    Public Sub StartingPoint()
        '#Region radspreadprocessing-features-merge-unmerge-cells_8
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<p>As a result of the merge, the four cells appear as one. The content of the newly created cell is equal to the top left cell of the merged region, i.e. <em>A1</em>. At this point, the values of the rest of the cells in the merged region are cleared, so now cells <em>A2, B1 and B2</em> have no values.</p>

<p><strong>Figure 2</strong> demonstrates the result of <strong>Example 2</strong> executed over the worksheet created in <strong>Example 1</strong>.</p>

<p>Figure 2: Merge operation result<img src="images/spreadprocessing-features-merge-unmerge-cells002.png" alt="spreadprocessing-features-merge-unmerge-cells 002"></p>

<p>Letâ€™s see how the <strong>MergeAcross()</strong> method will change the same region in the original worksheet:</p>

<p><strong>Example 3</strong> illustrates how to perform a merge operation on the cell region <em>A1:B2</em>.</p>

<h4><strong>[C#] Example 3: Perform merge across</strong></h4>

<pre><code>            Workbook workbook = new Workbook();
            Worksheet worksheet = workbook.Worksheets.Add();
            CellIndex A1Cell = new CellIndex(0, 0);
            CellIndex B2Cell = new CellIndex(1, 1);
            worksheet.Cells[A1Cell, B2Cell].MergeAcross();
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1Cell As New CellIndex(0, 0)
        Dim B2Cell As New CellIndex(1, 1)
        worksheet.Cells(A1Cell, B2Cell).MergeAcross()

        '#End Region
    End Sub

    Public Sub MergeB2C3()
        '#Region radspreadprocessing-features-merge-unmerge-cells_2

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2Cell As New CellIndex(1, 1)
        Dim C3Cell As New CellIndex(2, 2)
        worksheet.Cells(B2Cell, C3Cell).Merge()

        '#End Region
    End Sub

    Public Sub CheckA1IsMerged()
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        '#Region radspreadprocessing-features-merge-unmerge-cells_3

        Dim A1CellIndex As New CellIndex(0, 0)
        Dim isA1merged As Boolean = Worksheet.Cells.GetIsMerged(A1CellIndex)

        '#End Region
    End Sub

    Public Sub GetContainingMergedRangeForCellA1()
        '#Region radspreadprocessing-features-merge-unmerge-cells_4

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim mergedCellRange As CellRange
        Dim canGetContainingMergedCellRange As Boolean = worksheet.Cells.TryGetContainingMergedRange(A1CellIndex, mergedCellRange)

        '#End Region
    End Sub

    Public Sub GetAllContainingMergedRangesInRange()
        '#Region radspreadprocessing-features-merge-unmerge-cells_5

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim N33CellIndex As New CellIndex(32, 13)
        Dim A1N33CellRange As New CellRange(A1CellIndex, N33CellIndex)
        Dim containingMergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetContainingMergedRanges(A1N33CellRange)

        '#End Region
    End Sub

    Public Sub GetAllMergedCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_6

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim mergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetMergedCellRanges()

        '#End Region
    End Sub

    Public Sub UnmergeCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_7

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2CellIndex As New CellIndex(1, 1)
        Dim D4CellIndex As New CellIndex(3, 3)
        Dim B2D4CellSelection As New CellRange(B2CellIndex, D4CellIndex)
        worksheet.Cells(B2D4CellSelection).Unmerge()

        '#End Region
    End Sub

    Public Sub StartingPoint()
        '#Region radspreadprocessing-features-merge-unmerge-cells_8
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<p>Note that unlike <strong>Merge()</strong>, the <strong>MergeAcross()</strong> method creates a new cell for every row. Each newly created cell contains the value of the leftmost cell that is in the same row and in the merged region. The value of the rest of the merged cells is cleared, so cells <em>B1</em> and <em>B2</em> have an empty value.</p>

<p><strong>Figure 3</strong> demonstrates the result of <strong>Example 3</strong> executed over the worksheet created in <strong>Example 1</strong>.</p>

<p>Figure 3: Merge across operation result<img src="images/spreadprocessing-features-merge-unmerge-cells003.png" alt="spreadprocessing-features-merge-unmerge-cells 003"></p>

<p>If you now try to merge a cell range that intersects with another merged cell range, a third merged cell range will be produced out of the top-left and bottom-right cells of the two ranges.</p>

<p><strong>Example 4</strong> merges across the region <em>A1:B2</em> and then performs another merge on the cells in the region <em>B2:C3</em>:</p>

<h4>__[C#] Example 4: Intersect cell range with merged cell range __</h4>

<pre><code>            Workbook workbook = new Workbook();
            Worksheet worksheet = workbook.Worksheets.Add();
            CellIndex B2Cell = new CellIndex(1, 1);
            CellIndex C3Cell = new CellIndex(2, 2);
            worksheet.Cells[B2Cell, C3Cell].Merge();
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2Cell As New CellIndex(1, 1)
        Dim C3Cell As New CellIndex(2, 2)
        worksheet.Cells(B2Cell, C3Cell).Merge()

        '#End Region
    End Sub

    Public Sub CheckA1IsMerged()
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        '#Region radspreadprocessing-features-merge-unmerge-cells_3

        Dim A1CellIndex As New CellIndex(0, 0)
        Dim isA1merged As Boolean = Worksheet.Cells.GetIsMerged(A1CellIndex)

        '#End Region
    End Sub

    Public Sub GetContainingMergedRangeForCellA1()
        '#Region radspreadprocessing-features-merge-unmerge-cells_4

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim mergedCellRange As CellRange
        Dim canGetContainingMergedCellRange As Boolean = worksheet.Cells.TryGetContainingMergedRange(A1CellIndex, mergedCellRange)

        '#End Region
    End Sub

    Public Sub GetAllContainingMergedRangesInRange()
        '#Region radspreadprocessing-features-merge-unmerge-cells_5

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim N33CellIndex As New CellIndex(32, 13)
        Dim A1N33CellRange As New CellRange(A1CellIndex, N33CellIndex)
        Dim containingMergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetContainingMergedRanges(A1N33CellRange)

        '#End Region
    End Sub

    Public Sub GetAllMergedCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_6

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim mergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetMergedCellRanges()

        '#End Region
    End Sub

    Public Sub UnmergeCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_7

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2CellIndex As New CellIndex(1, 1)
        Dim D4CellIndex As New CellIndex(3, 3)
        Dim B2D4CellSelection As New CellRange(B2CellIndex, D4CellIndex)
        worksheet.Cells(B2D4CellSelection).Unmerge()

        '#End Region
    End Sub

    Public Sub StartingPoint()
        '#Region radspreadprocessing-features-merge-unmerge-cells_8
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<p>The result is a merged cell that ranges from <em>A1</em> to <em>C3</em>.</p>

<p><strong>Figure 4</strong> demonstrates the result of <strong>Example 4</strong> executed over the worksheet created in <strong>Example 1</strong>.</p>

<p>Figure 4: Merge cell range with merged cell range result<img src="images/spreadprocessing-features-merge-unmerge-cells004.png" alt="spreadprocessing-features-merge-unmerge-cells 004"></p>

<h2 id="get-merged-cell-ranges"><a href="#get-merged-cell-ranges">Get Merged Cell Ranges</a></h2>

<p>In some scenarios you may want to know if a particular cell is part of a merged region. In others, you may need to retrieve all merged ranges. This section outlines the possible approaches for getting the merged regions.</p>

<h3 id="how-to-check-if-a-cell-is-merged"><a href="#how-to-check-if-a-cell-is-merged">How to check if a cell is merged?</a></h3>

<p>The Cells class exposes a <strong>GetIsMerged()</strong> method that allows you to determine if a cell belongs to a merged cell. The method takes a single parameter of type <strong>CellIndex</strong> which designates a cell you would like to inspect and returns a Boolean value that indicates whether the cell is contained in a merged cell.</p>

<p><strong>Example 5</strong> checks if cell A1 is in a merged region.</p>

<h4><strong>[C#] Example 5: Check if cell is in merged cell range</strong></h4>

<pre><code>            CellIndex A1CellIndex = new CellIndex(0, 0);
            bool isA1merged = worksheet.Cells.GetIsMerged(A1CellIndex);
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim A1CellIndex As New CellIndex(0, 0)
        Dim isA1merged As Boolean = Worksheet.Cells.GetIsMerged(A1CellIndex)

        '#End Region
    End Sub

    Public Sub GetContainingMergedRangeForCellA1()
        '#Region radspreadprocessing-features-merge-unmerge-cells_4

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim mergedCellRange As CellRange
        Dim canGetContainingMergedCellRange As Boolean = worksheet.Cells.TryGetContainingMergedRange(A1CellIndex, mergedCellRange)

        '#End Region
    End Sub

    Public Sub GetAllContainingMergedRangesInRange()
        '#Region radspreadprocessing-features-merge-unmerge-cells_5

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim N33CellIndex As New CellIndex(32, 13)
        Dim A1N33CellRange As New CellRange(A1CellIndex, N33CellIndex)
        Dim containingMergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetContainingMergedRanges(A1N33CellRange)

        '#End Region
    End Sub

    Public Sub GetAllMergedCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_6

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim mergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetMergedCellRanges()

        '#End Region
    End Sub

    Public Sub UnmergeCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_7

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2CellIndex As New CellIndex(1, 1)
        Dim D4CellIndex As New CellIndex(3, 3)
        Dim B2D4CellSelection As New CellRange(B2CellIndex, D4CellIndex)
        worksheet.Cells(B2D4CellSelection).Unmerge()

        '#End Region
    End Sub

    Public Sub StartingPoint()
        '#Region radspreadprocessing-features-merge-unmerge-cells_8
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<h3 id="how-to-get-the-containing-merged-cell-range-if-the-cell-is-merged"><a href="#how-to-get-the-containing-merged-cell-range-if-the-cell-is-merged">How to get the containing merged cell range, if the cell is merged?</a></h3>

<p>Another way to check if a cell belongs to a merged range is to use the <strong>TryGetContainingMergedRange()</strong> method of the <strong>Cells</strong> class. Similarly to the GetIsMerged(), this method returns a Boolean value which indicates if the cell actually is contained in a merged cell. It requires a <strong>CellIndex</strong> parameter that points the cell to be checked. The method also has one additional out parameter of type CellRange that holds the merged range of the cell, if the cell belongs to such.</p>

<p><strong>Example 6</strong> shows how to use TryGetContainingMergedRange() method.</p>

<h4><strong>[C#] Example 6: Try get merged cell range</strong></h4>

<pre><code>            CellIndex A1CellIndex = new CellIndex(0, 0);
            CellRange mergedCellRange;
            bool canGetContainingMergedCellRange = worksheet.Cells.TryGetContainingMergedRange(A1CellIndex, out mergedCellRange);
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim mergedCellRange As CellRange
        Dim canGetContainingMergedCellRange As Boolean = worksheet.Cells.TryGetContainingMergedRange(A1CellIndex, mergedCellRange)

        '#End Region
    End Sub

    Public Sub GetAllContainingMergedRangesInRange()
        '#Region radspreadprocessing-features-merge-unmerge-cells_5

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim N33CellIndex As New CellIndex(32, 13)
        Dim A1N33CellRange As New CellRange(A1CellIndex, N33CellIndex)
        Dim containingMergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetContainingMergedRanges(A1N33CellRange)

        '#End Region
    End Sub

    Public Sub GetAllMergedCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_6

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim mergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetMergedCellRanges()

        '#End Region
    End Sub

    Public Sub UnmergeCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_7

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2CellIndex As New CellIndex(1, 1)
        Dim D4CellIndex As New CellIndex(3, 3)
        Dim B2D4CellSelection As New CellRange(B2CellIndex, D4CellIndex)
        worksheet.Cells(B2D4CellSelection).Unmerge()

        '#End Region
    End Sub

    Public Sub StartingPoint()
        '#Region radspreadprocessing-features-merge-unmerge-cells_8
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<h3 id="how-to-get-all-merged-cell-ranges-contained-in-a-given-cell-range"><a href="#how-to-get-all-merged-cell-ranges-contained-in-a-given-cell-range">How to get all merged cell ranges contained in a given cell range?</a></h3>

<p>Use the <strong>GetContainingMergedRanges()</strong> method of the <strong>Cells</strong> class to retrieve all merged cells in a specified range. The method takes a single argument of type <strong>CellRange</strong> that determines the range of the search and returns an enumerable that contains all merged cell ranges.</p>

<p><strong>Example 7</strong> shows how to use GetContainingMergedRanges() method.</p>

<h4><strong>[C#] Example 7: Get all containing merged ranges in a range</strong></h4>

<pre><code>            CellIndex A1CellIndex = new CellIndex(0, 0);
            CellIndex N33CellIndex = new CellIndex(32, 13);
            CellRange A1N33CellRange = new CellRange(A1CellIndex, N33CellIndex);
            IEnumerable&lt;CellRange&gt; containingMergedCellRanges = worksheet.Cells.GetContainingMergedRanges(A1N33CellRange);
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim A1CellIndex As New CellIndex(0, 0)
        Dim N33CellIndex As New CellIndex(32, 13)
        Dim A1N33CellRange As New CellRange(A1CellIndex, N33CellIndex)
        Dim containingMergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetContainingMergedRanges(A1N33CellRange)

        '#End Region
    End Sub

    Public Sub GetAllMergedCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_6

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim mergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetMergedCellRanges()

        '#End Region
    End Sub

    Public Sub UnmergeCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_7

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2CellIndex As New CellIndex(1, 1)
        Dim D4CellIndex As New CellIndex(3, 3)
        Dim B2D4CellSelection As New CellRange(B2CellIndex, D4CellIndex)
        worksheet.Cells(B2D4CellSelection).Unmerge()

        '#End Region
    End Sub

    Public Sub StartingPoint()
        '#Region radspreadprocessing-features-merge-unmerge-cells_8
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<h3 id="how-to-get-all-merged-ranges"><a href="#how-to-get-all-merged-ranges">How to get all merged ranges?</a></h3>

<p>The <strong>GetMergedCellRanges()</strong> method of the <strong>Cells</strong> class returns an enumeration holding all merged cell ranges in the worksheet.</p>

<p><strong>Example 8</strong> shows how to get all merged ranges in a worksheet.</p>

<h4><strong>[C#] Example 8: Get all merged ranges</strong></h4>

<pre><code>            Workbook workbook = new Workbook();
            Worksheet worksheet = workbook.Worksheets.Add();
            IEnumerable&lt;CellRange&gt; mergedCellRanges = worksheet.Cells.GetMergedCellRanges();
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim mergedCellRanges As IEnumerable(Of CellRange) = worksheet.Cells.GetMergedCellRanges()

        '#End Region
    End Sub

    Public Sub UnmergeCells()
        '#Region radspreadprocessing-features-merge-unmerge-cells_7

        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2CellIndex As New CellIndex(1, 1)
        Dim D4CellIndex As New CellIndex(3, 3)
        Dim B2D4CellSelection As New CellRange(B2CellIndex, D4CellIndex)
        worksheet.Cells(B2D4CellSelection).Unmerge()

        '#End Region
    End Sub

    Public Sub StartingPoint()
        '#Region radspreadprocessing-features-merge-unmerge-cells_8
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<h2 id="unmerge-cells"><a href="#unmerge-cells">Unmerge Cells</a></h2>

<p>Once a cell is merged, the API offers an easy way to split it back to its composing cells. This is achieved through the <strong>Unmerge()</strong> method of the <strong>CellSelection</strong> class. When this method is invoked it unmerges all merged cell ranges that intersect with the selected cell range. For example, consider the worksheet in <strong>Figure 5</strong> that has the regions <em>A1:B2</em> and <em>D4:E5</em> merged.</p>

<p>Figure 5: Sample worksheet<img src="images/spreadprocessing-features-merge-unmerge-cells005.png" alt="spreadprocessing-features-merge-unmerge-cells 005"></p>

<p><strong>Example 9</strong> invokes the <strong>Unmerge()</strong> method for the region <em>B2:D4</em> of the worksheet from <strong>Figure 5</strong>, which intersects with the two merged ranges.</p>

<h4><strong>[C#] Example 9: Unmerge cells</strong></h4>

<pre><code>            CellIndex B2CellIndex = new CellIndex(1, 1);
            CellIndex D4CellIndex = new CellIndex(3, 3);
            CellRange B2D4CellSelection = new CellRange(B2CellIndex, D4CellIndex);
            worksheet.Cells[B2D4CellSelection].Unmerge();
</code></pre>

<h4><strong>VB</strong></h4>

<pre><code>        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        Dim B2CellIndex As New CellIndex(1, 1)
        Dim D4CellIndex As New CellIndex(3, 3)
        Dim B2D4CellSelection As New CellRange(B2CellIndex, D4CellIndex)
        worksheet.Cells(B2D4CellSelection).Unmerge()

        '#End Region
    End Sub

    Public Sub StartingPoint()
        '#Region radspreadprocessing-features-merge-unmerge-cells_8
        Dim workbook As New Workbook()
        Dim worksheet As Worksheet = workbook.Worksheets.Add()
        worksheet.Cells(0, 0).SetValue("A1")
        worksheet.Cells(1, 0).SetValue("A2")
        worksheet.Cells(0, 1).SetValue("B1")
        worksheet.Cells(1, 1).SetValue("B2")
        '#End Region
    End Sub
End Class
</code></pre>

<p><strong>Figure 6</strong> shows that as a result, the two ranges are unmerged.</p>

<p>Figure 6: Result of unmerge action<img src="images/spreadprocessing-features-merge-unmerge-cells006.png" alt="spreadprocessing-features-merge-unmerge-cells 006"></p>
        </article>
    </div>	
</div>

<footer>	
    <p><a onclick="javascript:SubmitFeedback('documentation@telerik.com','Telerik UI for WinForms','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback'); return false;" href="javascript:;" id="send-feedback">Send Feedback</a> Copyright &copy; 2002-<span id="toYear"></span> Telerik. All rights reserved.</p>
</footer>

    </body>
</html>

